/*! common.js created_at:2018-05-03 */

!function(l){l.fn.extend({center:function(n){return n=l.extend({fixed:!0},n),this.each(function(){var e=(l(window).height()-l(this).outerHeight())/2,t=(l(window).width()-l(this).outerWidth())/2;n.fixed?l(this).css({position:"fixed",margin:0,top:e,left:t}):l(this).css({position:"absolute",margin:0,top:e+l(document).scrollTop(),left:t+l(document).scrollLeft()})})},dragable:function(e){e=l.extend({},e);var s=this,a={x:0,y:0};l(this).css({position:"absolute"}),this.moveDiv=function(e){var t=window.event||e,n=l(s).offset(),o=n.top+(t.clientY-a.y),i=n.left+(t.clientX-a.x);l(s).css({top:o,left:i}),a.x=t.clientX,a.y=t.clientY};var n=e.handle?l(e.handle):l(this);n.mousedown(function(e){var t=window.event||e;a.x=t.clientX,a.y=t.clientY,l(document).bind("mousemove",s.moveDiv),n.css({cursor:"move"})}),l(document).mouseup(function(){l(document).unbind("mousemove",s.moveDiv),n.css({cursor:"default"})})},insertContent:function(e,t){var n=l(this)[0];if(document.selection){this.focus();var o=document.selection.createRange();o.text=e,o.moveStart("character",-s);var i=o.text.length;if(2==arguments.length){var s=n.value.length;o.moveEnd("character",i+t),t<=0?o.moveStart("character",i-2*t-e.length):o.moveStart("character",i-t-e.length),o.select()}}else if(n.selectionStart||"0"==n.selectionStart){var a=n.selectionStart,r=n.selectionEnd,c=n.scrollTop;n.value=n.value.substring(0,a)+e+n.value.substring(r,n.value.length),this.focus(),n.selectionStart=a+e.length,n.selectionEnd=a+e.length,n.scrollTop=c,2==arguments.length&&(n.setSelectionRange(a-t,n.selectionEnd+t),this.focus())}else this.value+=e,this.focus()},disable:function(){l(this).prop("disabled",!0)},enable:function(){l(this).prop("disabled",!1)}})}(jQuery),function(a){a.fn.extend({confirm:function(e){var i=a.extend({event:"click",text:"确定要删除吗?",btnYes:"确定",btnNo:"取消"},e),s=a('<div id="dsxui-confirm-box" class="dsxui-confirm-box"><dl><dt class="txt">'+i.text+'</dt><dd><span class="btn btn-yes" tabindex="1">'+i.btnYes+'</span><span class="btn btn-no" tabindex="1">'+i.btnNo+"</span></dd></dl></div>");a(this).on(i.event,function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0;var t=this,n=a(this).offset(),o=parseInt(n.top+a(this).outerHeight())+7;a(document.body).append(s),s.css({top:o+"px",display:"none",position:"absolute"}).fadeIn("fast"),n.left>a(document).width()/2?s.css({right:a(document).width()-(n.left+a(this).outerWidth())+"px"}):s.css({left:n.left+"px"}),s.find(".btn-yes").one("click",function(){s.remove(),i.onConfirm&&i.onConfirm(s,t)}),s.find(".btn-no").click(function(){s.remove(),i.onCancel&&i.onCancel(s,t)}),s.click(function(e){var t=window.event||e;t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}),a(document).on("click",function(){s.remove()})})}})}(jQuery),function(v){v.fn.marquee=function(n){n=v.extend({speed:30,step:1,direction:"left",pause:0,container:"ul",items:"li"},n||{});var e,t=v.inArray(n.direction,["right","down"]);-1<t&&(n.direction=["left","up"][t],n.step=-n.step);var o=v(this),i=o.innerWidth(),s=o.innerHeight(),a=o.find(n.container),r=a.find(n.items),c=r.size(),l=r.width(),d=r.height(),u=l*c,f=d*c;function p(){if("left"===n.direction){var e=o.scrollLeft();n.step<0?o.scrollLeft((e<=0?u:e)+n.step):o.scrollLeft((u<=e?0:e)+n.step),e%l==0&&h()}else{var t=o.scrollTop();n.step<0?o.scrollTop((t<=0?f:t)+n.step):o.scrollTop((f<=t?0:t)+n.step),t%d==0&&h()}}function h(){if(0<n.pause){var e=n.step;n.step=0,setTimeout(function(){n.step=e},n.pause)}}o.height(d),("left"===n.direction&&i<u||"up"===n.direction&&s<f)&&("left"===n.direction?(a.width(2*c*l),n.step<0&&o.scrollLeft(u)):(a.height(2*c*d),n.step<0&&o.scrollTop(f)),a.append(r.clone()),e=setInterval(p,n.speed),o.hover(function(){clearInterval(e)},function(){e=setInterval(p,n.speed)}))}}(jQuery);var DSXValidate={IsURL:function(e){return/^http:\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\:+!]*([^<>])*$/.test(e)},IsChineseName:function(e){return/^[\u4e00-\u9fa5]{2,12}$/.test(e)},IsUserName:function(e){return/^[a-zA-Z0-9_\u4e00-\u9fa5]{2,20}$/.test(e)},IsEmail:function(e){return/^[-._A-Za-z0-9]+@([A-Za-z0-9]+\.)+[A-Za-z]{2,3}$/.test(e)},IsMobile:function(e){return/^1[3|4|5|7|8]\d{9}$/.test(e)},IsPassword:function(e){return/^.{6,20}$/.test(e)},IsIdCardNo:function(e){var o=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1],i=[1,0,10,9,8,7,6,5,4,3,2];if(this.isTrueValidateCodeBy18IdCard=function(e){var t=0;"x"===e[17].toLowerCase()&&(e[17]=10);for(var n=0;n<17;n++)t+=o[n]*e[n];return valCodePosition=t%11,e[17]==i[valCodePosition]},this.isValidityBrithBy18IdCard=function(e){var t=e.substring(6,10),n=e.substring(10,12),o=e.substring(12,14),i=new Date(t,parseFloat(n)-1,parseFloat(o));return i.getFullYear()==parseFloat(t)&&i.getMonth()==parseFloat(n)-1&&i.getDate()==parseFloat(o)},this.isValidityBrithBy15IdCard=function(e){var t=e.substring(6,8),n=e.substring(8,10),o=e.substring(10,12),i=new Date(t,parseFloat(n)-1,parseFloat(o));return i.getYear()==parseFloat(t)&&i.getMonth()==parseFloat(n)-1&&i.getDate()==parseFloat(o)},15===(e=(e=e.replace(/ /g,"")).replace(/(^\s*)|(\s*$)/g,"")).length)return this.isValidityBrithBy15IdCard(e);if(18==e.length){var t=e.split("");return!(!this.isValidityBrithBy18IdCard(e)||!this.isTrueValidateCodeBy18IdCard(t))}return!1}},DSXUtil={mb_cutstr:function(e,t,n){var o=0,i="";t-=(n=n?"":"...").length;for(var s=0;s<e.length;s++){if(t<(o+=e.charCodeAt(s)<0||255<e.charCodeAt(s)?"utf-8"===charset?3:2:1)){i+=n;break}i+=e.substr(s,1)}return i},paramToJSON:function(e){if(e){var o={},t=e.split("&");return $.each(t,function(e,t){var n=t.split("=");o[n[0]]=n[1]?n[1]:""}),o}},randomString:function(e){e=e||32;var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=t.length,o="";for(i=0;i<e;i++)o+=t.charAt(Math.floor(Math.random()*n));return o},getQueryString:function(e){var t=location.search.match(new RegExp("[?&]"+e+"=([^&]*)(&?)","i"));return t?t[1]:t},changeURLArg:function(url,arg,arg_val){var pattern=arg+"=([^&]*)",replaceText=arg+"="+arg_val;if(url.match(pattern)){var tmp="/("+arg+"=)([^&]*)/gi";return tmp=url.replace(eval(tmp),replaceText),tmp}return url.match("[?]")?url+"&"+replaceText:url+"?"+replaceText},setCookie:function(e,t,n){var o=e+"="+escape(t);if(0<n){var i=new Date;i.setTime(i.getTime()+3600*n*1e3),o=o+"; expires="+i.toGMTString()}document.cookie=o},getCookie:function(e){for(var t=document.cookie.split("; "),n=0;n<t.length;n++){var o=t[n].split("=");if(e===o[0])return o[1]?unescape(o[1]):null}return null},reFresh:function(){window.location=window.location.href},stopPropagation:function(e){var t=e||window.event;t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}};function DSXDialog(e){var t=$.extend({title:"标题",confirmText:"确定",cancelText:"取消",content:"在这里输入内容",fixed:!0,dragable:!0,showHeader:!0,showFooter:!0,style:{width:"600px"},top:"15%"},e),o=this,n=window,s=window.document,i=DSXDialog.__count,a='<div class="dialog-header"><h4 class="dialog-title">'+t.title+'</h4><a class="close">&times;</a></div>',r='<div class="dialog-footer"><button type="button" class="btn btn-default oncancel" tabindex="1">'+t.cancelText+'</button><button type="button" class="btn btn-primary onconfirm" tabindex="1">'+t.confirmText+"</button></div>",c=$('<div class="dialog-content">'+t.content+"</div>"),l=$("<div/>").addClass("dialog").css(t.style);t.showHeader&&l.append(a),l.append(c),t.showFooter&&l.append(r),this.id=t.id?t.id:"dsxui-modal-"+i,this.zIndex=t.zIndex?t.zIndex:i+1e3;var d=$('<div id="'+this.id+'" class="dsxui-modal"></div>').css({"z-index":this.zIndex+1}).append(l),u=$('<div id="dsxui-overlayer-'+i+'" class="dsxui-overlayer"></div>').css({"z-index":this.zIndex});this.setPosition=function(){var e=($(n).width()-d.outerWidth())/2;$(n).height(),d.outerHeight();d.css({top:t.top,left:e})},this.close=function(){t.willClose&&t.willClose(o),d.remove(),u.remove(),t.afterClose&&t.afterClose(o)};(function(){if(u.appendTo(s.body).show(),d.appendTo(s.body).show(),o.setPosition(),t.dragable){var i={x:0,y:0};function n(e){var t=window.event||e,n=parseInt(d.css("top"))+(t.clientY-i.y),o=parseInt(d.css("left"))+(t.clientX-i.x);d.css({top:n,left:o}),i.x=t.clientX,i.y=t.clientY}d.find(".dialog-header").mousedown(function(e){var t=window.event||e;i.x=t.clientX,i.y=t.clientY,$(s).bind("mousemove",n),$(this).css("cursor","move")}),$(s).on("mouseup",function(e){$(s).off("mousemove",n),d.find(".dialog-header").css("cursor","default")})}d.find(".close").on("click",o.close),d.find(".onconfirm").on("click",function(e){t.onConfirm&&t.onConfirm(o)}),d.find(".oncancel").on("click",function(e){t.onCancel&&t.onCancel(o),o.close()}),t.afterShow&&t.afterShow(o)}).call(this),DSXDialog.__count++}DSXDialog.__count=1;var DSXUI={message:function(e){var t,n=$.extend({type:"success",text:"操作完成"},e);switch("success"!==n.type&&"error"!==n.type&&"warning"!==n.type&&(n.type="infomation"),n.type){case"success":t="&#xe656;";break;case"error":t="&#xe658;";break;case"warning":t="&#xe662;";break;default:t="&#xe6e4;"}$("#dsxui-message-box").remove();var o=$("<div/>").addClass("dsxui-message-box").attr("id","dsxui-message-box"),i=$("<div/>").addClass("message-div message-"+n.type).html('<div class="iconfont message-icon">'+t+'</div><div class="message-text">'+n.text+"</div>");o.html(i).appendTo(document.body).fadeIn("fast").center().css("top","20%"),n.afterShow&&n.afterShow(o),setTimeout(function(){o.remove(),n.afterClose&&n.afterClose(o)},2e3)},success:function(e,t){DSXUI.message({type:"success",text:e,afterClose:t})},error:function(e,t){DSXUI.message({type:"error",text:e,afterClose:t})},warning:function(e,t){DSXUI.message({type:"warning",text:e,afterClose:t})},infomation:function(e,t){DSXUI.message({type:"infomation",text:e,afterClose:t})},confirm:function(e,t,n,o){$(e).confirm({text:t,onConfirm:n,onCancel:o})},loading:{isShow:!1},showloading:function(e){e=e||"数据加载中...";var t=DSXUI.loading;return t.overlayer=$("<div/>").addClass("dsxui-overlayer").appendTo(document.body),t.indicator=$('<div class="dsxui-loading-box" id="dsxui-loading-box"><span class="ico"></span>'+e+"</div>").appendTo(document.body).center(),t.isShow=!0,t.close=function(){t.isShow=!1,t.indicator.remove(),t.overlayer.remove()},t.hide=function(){t.close()},t},hideloading:function(){DSXUI.loading.isShow&&DSXUI.loading.close()},spinner:{isShow:!1,hide:null},showSpinner:function(){var e=DSXUI.spinner;return e.overlayer=$("<div/>").addClass("dsxui-overlayer").appendTo(document.body),e.indicator=$('<div class="dsxui-spinner" id="dsxui-spinner"></div>').appendTo(document.body).center(),e.isShow=!0,e.close=function(){e.isShow=!1,e.indicator.remove(),e.overlayer.remove()},e.hide=function(){e.close()},e},hideSpinner:function(){DSXUI.spinner.isShow&&DSXUI.spinner.hide()},toast:{isShow:!1,hide:null},showToast:function(e,t,n){t||(t=1500);var o=DSXUI.toast;o.isShow&&o.hide(),o.container=$("<div/>").addClass("dsxui-toast").attr("id","dsxui-toast").append('<div class="dsxui-toast-content">'+e+"</div>").appendTo(document.body).center(),o.isShow=!0,o.hide=function(){o.isShow=!1,o.container.remove(),n&&n()},setTimeout(o.hide,t)},hideToast:function(){DSXUI.toast.isShow&&DSXUI.toast.hide()},dialog:function(e){return new DSXDialog(e)},showConfirm:function(e,t,n,o){e||(e="删除确认"),t||(t="确认要删除此项目吗?"),DSXUI.dialog({style:{width:"400px"},title:e,content:'<div style="font-size: 14px;">'+t+"</div>",onConfirm:function(e){e.close(),n&&n(e)},onCancel:function(e){o&&o(e)}})},showImagePicker:function(n){DSXUI.dialog({style:{width:"780px"},top:"10%",title:"图片空间",showFooter:!1,content:'<div style="height: 510px; position: relative;"><iframe src="/plugin/image" frameborder="0" style="width: 100%; height: 100%; position: absolute;"></div>',afterShow:function(t){window.onPickedImage=function(e){t.close(),n&&n(e)}},afterClose:function(){window.onPickedImage=null}})}};function DistrictSelector(e){var a=$.extend({province:"",city:"",district:"",province_selector:"#province",city_selector:"#city",district_selector:"#district",valueType:"name"},e),n=function(t,e,s,n){e||(e=0),s||(s=0),$.ajax({url:"/api/district/batchget?fid="+e,dataType:"json",success:function(e){if(e.errcode)console.log(e);else{var i='<option value="">请选择</option>';$(e).each(function(e,t){var n,o;"id"===a.valueType?(n=t.id,o=s==t.id?' selected="selected"':""):(n=t.name,o=s==t.name?' selected="selected"':""),i+='<option value="'+n+'" idvalue='+t.id+o+">"+t.name+"</option>"}),$(t).html(i),n&&n()}}})};0<$(a.province_selector).length&&n(a.province_selector,0,a.province,function(){0<$(a.city_selector).length&&$(a.province_selector).on("change",function(e){var t=$(this).find("option:selected").attr("idvalue");0<t?n(a.city_selector,t,a.city,function(){0<$(a.district_selector).length&&$(a.city_selector).on("change",function(e){var t=$(this).find("option:selected").attr("idvalue");0<t?n(a.district_selector,t,a.county):$(a.district_selector).html('<option value="">请选择</option>')}).change()}):($(a.city_selector).html('<option value="">请选择</option>'),$(a.district_selector).html('<option value="">请选择</option>'))}).change()})}$(function(){$("[data-action=checkall]").on("click",function(){var e=$(this).attr("data-target");void 0===e&&(e="input.checkmark"),$(e).prop("checked",$(this).is(":checked"))}),$(".lazyload").lazyload({effect:"fadeIn",placeholder:"/images/common/placeholder.png"}),$(".asyncload").each(function(){var e=this,t=$(this).attr("data-original");"img"===this.tagName.toLowerCase()?($(this).attr("src","/images/common/placeholder.png"),$("<img/>").attr("src",t).load(function(){$(e).attr("src",t)})):$("<img/>").attr("src",t).load(function(){$(e).css("background-image","url("+t+")")})}),$(".sortable").sortable(),$("[data-action=refresh]").on("click",function(){DSXUtil.reFresh()})});